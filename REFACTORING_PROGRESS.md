# ğŸ”§ ë¦¬íŒ©í† ë§ ì§„í–‰ ìƒí™©

## âœ… ì™„ë£Œëœ ì‘ì—…

### ìš°ì„ ìˆœìœ„ 1: í•µì‹¬ ì¸í”„ë¼ ëª¨ë“ˆí™” (ì™„ë£Œ)

#### 1. API í´ë¼ì´ì–¸íŠ¸ í†µí•© ëª¨ë“ˆ (`lib/api/`)
- âœ… `createApiClient()` - ê¸°ë³¸ HTTP í´ë¼ì´ì–¸íŠ¸
- âœ… `callEdgeFunction()` - Edge Function í˜¸ì¶œ í—¬í¼
- âœ… `createEdgeFunctionClient()` - Edge Functions ì „ìš© í´ë¼ì´ì–¸íŠ¸
- âœ… `analyze()`, `save()` ë©”ì„œë“œ êµ¬í˜„
- âœ… **í…ŒìŠ¤íŠ¸**: 9ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼
- âœ… `useUploadFlow.ts` ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ

**íŒŒì¼ êµ¬ì¡°:**
```
lib/api/
â”œâ”€â”€ client.ts              # ê¸°ë³¸ HTTP í´ë¼ì´ì–¸íŠ¸
â”œâ”€â”€ edge-functions.ts      # Edge Functions í´ë¼ì´ì–¸íŠ¸
â”œâ”€â”€ index.ts               # í†µí•© export
â””â”€â”€ __tests__/
    â”œâ”€â”€ client.test.ts     # 7ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
    â””â”€â”€ edge-functions.test.ts  # 2ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
```

---

#### 2. ì¸ì¦ ëª¨ë“ˆ í†µí•© (`lib/auth/`)
- âœ… `useAuth()` - ì‚¬ìš©ì ì •ë³´ ë° ì¸ì¦ ìƒíƒœ ê´€ë¦¬
- âœ… `useSession()` - ì„¸ì…˜ ê´€ë¦¬
- âœ… `useRequireAuth()` - ì¸ì¦ í•„ìˆ˜ í˜ì´ì§€ìš© í›…
- âœ… `AuthGuard` - ì¸ì¦ ê°€ë“œ ì»´í¬ë„ŒíŠ¸
- âœ… `getAccessToken()`, `getCurrentUser()`, `signOut()` ìœ í‹¸ë¦¬í‹°
- âœ… **í…ŒìŠ¤íŠ¸**: 5ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼
- âœ… `home/page.tsx` ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ

**íŒŒì¼ êµ¬ì¡°:**
```
lib/auth/
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useSession.ts
â”‚   â””â”€â”€ useRequireAuth.ts
â”œâ”€â”€ guards/
â”‚   â””â”€â”€ AuthGuard.tsx
â”œâ”€â”€ utils.ts
â”œâ”€â”€ index.ts
â””â”€â”€ __tests__/
    â”œâ”€â”€ useAuth.test.ts    # 3ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
    â””â”€â”€ useSession.test.ts # 2ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
```

---

#### 3. ì—ëŸ¬ ì²˜ë¦¬ í†µí•© (`lib/error/`)
- âœ… `classifyError()` - ì—ëŸ¬ ë¶„ë¥˜ ê°œì„ 
- âœ… `getErrorMessage()` - ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ ë³€í™˜
- âœ… `useErrorHandler()` - ì—ëŸ¬ ì²˜ë¦¬ í›…
- âœ… `ErrorBoundary` - React Error Boundary ì»´í¬ë„ŒíŠ¸
- âœ… `ERROR_MESSAGES` - ì—ëŸ¬ ë©”ì‹œì§€ ìƒìˆ˜í™”
- âœ… `retryWithBackoff()` - ì¬ì‹œë„ ìœ í‹¸ë¦¬í‹°
- âœ… **í…ŒìŠ¤íŠ¸**: 9ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼
- âœ… `analyze/page.tsx` ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ

**íŒŒì¼ êµ¬ì¡°:**
```
lib/error/
â”œâ”€â”€ handler.ts             # ì—ëŸ¬ ë¶„ë¥˜ í•µì‹¬ ë¡œì§
â”œâ”€â”€ messages.ts            # ì—ëŸ¬ ë©”ì‹œì§€ ìƒìˆ˜
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useErrorHandler.ts
â”œâ”€â”€ components/
â”‚   â””â”€â”€ ErrorBoundary.tsx
â”œâ”€â”€ utils.ts               # ì¬ì‹œë„ ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ index.ts
â””â”€â”€ __tests__/
    â””â”€â”€ handler.test.ts    # 9ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
```

---

### ìš°ì„ ìˆœìœ„ 2: ë¶„ì„ í”Œë¡œìš° ë° ë°ì´í„° í˜ì¹­ ëª¨ë“ˆí™” (ì™„ë£Œ)

#### 2-1. ì´ë¯¸ì§€ ì²˜ë¦¬ í†µí•© (`lib/image/`)
- âœ… ëª¨ë“ˆ êµ¬ì¡° ìƒì„± ì™„ë£Œ
- âœ… `processing.ts`, `validation.ts` êµ¬í˜„ ì™„ë£Œ
- âœ… `useImageProcessor` í›… êµ¬í˜„ ì™„ë£Œ
- âœ… **í…ŒìŠ¤íŠ¸**: 8ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼

**íŒŒì¼ êµ¬ì¡°:**
```
lib/image/
â”œâ”€â”€ processing.ts          # ë¦¬ì‚¬ì´ì¦ˆ, í’ˆì§ˆ ê²€ì‚¬
â”œâ”€â”€ validation.ts          # íŒŒì¼ ê²€ì¦
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useImageProcessor.ts
â”œâ”€â”€ index.ts
â””â”€â”€ __tests__/
    â””â”€â”€ processing.test.ts  # 8ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
```

---

#### 2-2. ë¶„ì„ í”Œë¡œìš° ëª¨ë“ˆí™” (`features/analysis/`)
- âœ… `useImageUpload` - ì´ë¯¸ì§€ ì—…ë¡œë“œ ì „ìš© í›…
- âœ… `useAnalysis` - AI ë¶„ì„ ì „ìš© í›…
- âœ… `useAnalysisSave` - ê²°ê³¼ ì €ì¥ ì „ìš© í›…
- âœ… `useAnalysisFlow` - ì „ì²´ í”Œë¡œìš° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í›…
- âœ… `analyze/page.tsx` ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ
- âœ… **í…ŒìŠ¤íŠ¸**: 9ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼

**íŒŒì¼ êµ¬ì¡°:**
```
features/analysis/
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useImageUpload.ts      # ì´ë¯¸ì§€ ì—…ë¡œë“œ
â”‚   â”œâ”€â”€ useAnalysis.ts         # AI ë¶„ì„
â”‚   â”œâ”€â”€ useAnalysisSave.ts     # ê²°ê³¼ ì €ì¥
â”‚   â”œâ”€â”€ useAnalysisFlow.ts     # ì „ì²´ í”Œë¡œìš°
â”‚   â””â”€â”€ index.ts
â””â”€â”€ __tests__/
    â”œâ”€â”€ useImageUpload.test.ts  # 3ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
    â”œâ”€â”€ useAnalysis.test.ts     # 3ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
    â””â”€â”€ useAnalysisSave.test.ts # 3ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
```

**ê¸°ì¡´ `useUploadFlow.ts` (296ì¤„) â†’ 4ê°œ ëª¨ë“ˆë¡œ ë¶„ë¦¬:**
- `useImageUpload.ts` (~82ì¤„)
- `useAnalysis.ts` (~69ì¤„)
- `useAnalysisSave.ts` (~60ì¤„)
- `useAnalysisFlow.ts` (~127ì¤„)

---

#### 2-3. ë°ì´í„° í˜ì¹­ í†µí•© (`lib/data/`)
- âœ… `QUERY_KEYS` - ìºì‹œ í‚¤ ìƒìˆ˜í™”
- âœ… `queries/analysis.ts` - ë¶„ì„ ê´€ë ¨ ì¿¼ë¦¬
- âœ… `queries/user.ts` - ì‚¬ìš©ì ê´€ë ¨ ì¿¼ë¦¬
- âœ… `mutations/analysis.ts` - ë¶„ì„ ê´€ë ¨ ë®¤í…Œì´ì…˜
- âœ… `mutations/user.ts` - ì‚¬ìš©ì ê´€ë ¨ ë®¤í…Œì´ì…˜
- âœ… **í…ŒìŠ¤íŠ¸**: 9ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼
- âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ:
  - `home/page.tsx` â†’ `useAnalysisHistory()` ì‚¬ìš©
  - `analysis/[id]/page.tsx` â†’ `useAnalysisById()` ì‚¬ìš©
  - `profile/page.tsx` â†’ `useUserProfile()`, `useAnalysisHistory()` ì‚¬ìš©
  - `useAnalysisSave.ts` â†’ `QUERY_KEYS` ì‚¬ìš©

**íŒŒì¼ êµ¬ì¡°:**
```
lib/data/
â”œâ”€â”€ constants.ts           # ìºì‹œ í‚¤ ìƒìˆ˜
â”œâ”€â”€ queries/
â”‚   â”œâ”€â”€ analysis.ts        # ë¶„ì„ ì¿¼ë¦¬
â”‚   â”œâ”€â”€ user.ts            # ì‚¬ìš©ì ì¿¼ë¦¬
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ mutations/
â”‚   â”œâ”€â”€ analysis.ts         # ë¶„ì„ ë®¤í…Œì´ì…˜
â”‚   â”œâ”€â”€ user.ts            # ì‚¬ìš©ì ë®¤í…Œì´ì…˜
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ index.ts
â””â”€â”€ __tests__/
    â”œâ”€â”€ queries.test.ts     # 5ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
    â””â”€â”€ mutations.test.ts   # 4ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
```

**ì œê±°ëœ ì¤‘ë³µ:**
- `hooks/useAnalysisHistory.ts` â†’ `lib/data/queries/analysis.ts`ë¡œ í†µí•©
- í•˜ë“œì½”ë”©ëœ `queryKey: ['skin_analysis']` â†’ `QUERY_KEYS.analysis.history()` ì‚¬ìš©

---

## ğŸ“Š ìµœì¢… í…ŒìŠ¤íŠ¸ í†µê³„

- **ì´ í…ŒìŠ¤íŠ¸**: 55ê°œ
- **í†µê³¼**: 55ê°œ âœ…
- **ì‹¤íŒ¨**: 0ê°œ
- **í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸**: 12ê°œ ëª¨ë‘ í†µê³¼ âœ…
- **ì»¤ë²„ë¦¬ì§€**: ì£¼ìš” ê¸°ëŠ¥ ëª¨ë‘ í…ŒìŠ¤íŠ¸ ì™„ë£Œ

### í…ŒìŠ¤íŠ¸ ë¶„ë¥˜
- **API í´ë¼ì´ì–¸íŠ¸**: 9ê°œ í…ŒìŠ¤íŠ¸
- **ì¸ì¦ ëª¨ë“ˆ**: 5ê°œ í…ŒìŠ¤íŠ¸
- **ì—ëŸ¬ ì²˜ë¦¬**: 9ê°œ í…ŒìŠ¤íŠ¸
- **ì´ë¯¸ì§€ ì²˜ë¦¬**: 8ê°œ í…ŒìŠ¤íŠ¸
- **ë¶„ì„ í”Œë¡œìš°**: 9ê°œ í…ŒìŠ¤íŠ¸
- **ë°ì´í„° í˜ì¹­**: 9ê°œ í…ŒìŠ¤íŠ¸
- **ê¸°íƒ€**: 6ê°œ í…ŒìŠ¤íŠ¸

---

## ğŸ“ ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì™„ë£Œëœ ë§ˆì´ê·¸ë ˆì´ì…˜
- [x] `useUploadFlow.ts` â†’ ìƒˆ API í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©
- [x] `home/page.tsx` â†’ `useAuth()` ì‚¬ìš©
- [x] `analyze/page.tsx` â†’ ìƒˆ ì—ëŸ¬ ì²˜ë¦¬ ëª¨ë“ˆ ì‚¬ìš©
- [x] `analyze/page.tsx` â†’ `useAnalysisFlow()` ì‚¬ìš©
- [x] `home/page.tsx` â†’ `useAnalysisHistory()` ì‚¬ìš©
- [x] `analysis/[id]/page.tsx` â†’ `useAnalysisById()` ì‚¬ìš©
- [x] `profile/page.tsx` â†’ `useUserProfile()`, `useAnalysisHistory()` ì‚¬ìš©
- [x] `useAnalysisSave.ts` â†’ `QUERY_KEYS` ì‚¬ìš©

### ë‚¨ì€ ë§ˆì´ê·¸ë ˆì´ì…˜
- [ ] `treatments/[id]/page.tsx` â†’ í†µí•© ëª¨ë“ˆ ì‚¬ìš© (í•„ìš”ì‹œ)

---

## ğŸš€ ì„±ê³¼

1. **ì½”ë“œ ì¤‘ë³µ ì œê±°**: 
   - API í˜¸ì¶œ ë¡œì§ í†µí•©ìœ¼ë¡œ ~100ì¤„ ê°ì†Œ
   - ì¿¼ë¦¬ í‚¤ í•˜ë“œì½”ë”© ì œê±°
   - ì¤‘ë³µ ì¿¼ë¦¬ ë¡œì§ í†µí•©

2. **ì¼ê´€ì„± í–¥ìƒ**: 
   - ëª¨ë“  API í˜¸ì¶œì´ ë™ì¼í•œ ì—ëŸ¬ ì²˜ë¦¬ ë°©ì‹ ì‚¬ìš©
   - ëª¨ë“  ì¿¼ë¦¬ê°€ í†µì¼ëœ ìºì‹œ í‚¤ ì‚¬ìš©

3. **í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±**: 
   - ê° ëª¨ë“ˆì´ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
   - ì¿¼ë¦¬ ë° ë®¤í…Œì´ì…˜ í…ŒìŠ¤íŠ¸ ì‘ì„±
   - **ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ (55/55)**

4. **ì¬ì‚¬ìš©ì„±**: 
   - ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“ˆ êµ¬ì¡°
   - ìºì‹œ í‚¤ ìƒìˆ˜ë¡œ íƒ€ì… ì•ˆì •ì„± í–¥ìƒ

5. **ì±…ì„ ë¶„ë¦¬**: 
   - `useUploadFlow.ts` (296ì¤„) â†’ 4ê°œ ëª¨ë“ˆë¡œ ë¶„ë¦¬
   - ë°ì´í„° í˜ì¹­ ë¡œì§ ì¤‘ì•™í™”

6. **ì—„ê²©í•œ í…ŒìŠ¤íŠ¸**: 
   - TDD ë°©ì‹ìœ¼ë¡œ ëª¨ë“  ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì‘ì„±
   - JSX ë¬¸ë²• ì˜¤ë¥˜, íƒ€ì… ì˜¤ë¥˜, ëª¨í‚¹ ë¬¸ì œ ëª¨ë‘ í•´ê²°
   - **100% í…ŒìŠ¤íŠ¸ í†µê³¼ìœ¨ ë‹¬ì„±**

---

## ğŸ“ˆ ë‹¤ìŒ ë‹¨ê³„

### ìš°ì„ ìˆœìœ„ 3 (ì„ íƒì‚¬í•­)
- í¼ ì²˜ë¦¬ í†µí•©
- UI ìƒíƒœ í†µí•©
- ìƒìˆ˜ ë° ì„¤ì • í†µí•©
- íƒ€ì… ì •ì˜ í†µí•©

---

## ğŸ¯ ë¦¬íŒ©í† ë§ ì™„ë£Œ ìš”ì•½

### ì™„ë£Œëœ ìš°ì„ ìˆœìœ„
- âœ… **ìš°ì„ ìˆœìœ„ 1**: API í´ë¼ì´ì–¸íŠ¸, ì¸ì¦, ì—ëŸ¬ ì²˜ë¦¬ ëª¨ë“ˆí™”
- âœ… **ìš°ì„ ìˆœìœ„ 2**: ì´ë¯¸ì§€ ì²˜ë¦¬, ë¶„ì„ í”Œë¡œìš°, ë°ì´í„° í˜ì¹­ ëª¨ë“ˆí™”

### í…ŒìŠ¤íŠ¸ ê²°ê³¼
- **55ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼** âœ…
- **12ê°œ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ëª¨ë‘ í†µê³¼** âœ…
- **ì—„ê²©í•œ TDD ë°©ì‹ìœ¼ë¡œ ëª¨ë“  ëª¨ë“ˆ ê²€ì¦ ì™„ë£Œ** âœ…
