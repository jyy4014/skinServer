# 최종 개발 로드맵

## 📊 현재 상태 요약

### ✅ 완료된 기능

#### 1. 인증 시스템
- ✅ 회원가입 (Edge Function 기반, 서버 검증)
- ✅ 로그인 (이메일/비밀번호, Google OAuth)
- ✅ 프로필 완성도 기능
- ✅ 프로필 편집

#### 2. AI 분석 파이프라인 (백엔드 완료)
- ✅ **Stage A (Vision AI)**: Google Gemini 2.5 Pro 연동
  - 피부 상태 분석 (pigmentation, acne, redness, pores, wrinkles)
  - 마스크/히트맵 생성
  - 신뢰도 및 불확실성 추정
  - 다중 이미지 지원 (정면, 좌측, 우측)
  - 이미지 크기 검증 및 최적화 체크 (추가됨)
- ✅ **Stage B (Mapping AI)**: 규칙 기반 시술 매핑
  - 5가지 시술 정의 및 매핑
  - 안전성 규칙 적용
  - 점수 계산 및 순위 결정
- ✅ **Stage C (NLG AI)**: Google Gemini 2.5 Flash 연동
  - 사용자 친화적 문구 생성
  - 비의료적 문구 강제
  - 법적 면책 문구 자동 삽입
- ✅ **Orchestrator**: 3단계 파이프라인 순차 실행
- ✅ **Edge Function**: API 엔드포인트 완성

#### 3. UI/UX 기본 구조
- ✅ 온보딩 화면 (4단계)
- ✅ 홈 화면 (분석 CTA, 최근 결과, 추천 시술)
- ✅ 분석 화면 (이미지 업로드, 미리보기)
- ✅ 분석 결과 상세 화면
- ✅ 히스토리 화면
- ✅ 시술 상세 화면
- ✅ 프로필 화면

#### 4. 이미지 처리
- ✅ 클라이언트 사이드 리사이즈 (WebP 변환)
- ✅ 이미지 품질 검증 (Laplacian blur check)
- ✅ Edge Function 이미지 크기 검증 (추가됨)

#### 5. 코드 품질
- ✅ TypeScript 타입 정의
- ✅ React Query 상태 관리
- ✅ 에러 처리 및 분류
- ✅ 접근성 (A11y) 개선

---

## 🎯 개발 우선순위 (최종)

### 🔥 **P0: 즉시 확인 및 수정 (1-2일)**

#### 1. 환경 변수 설정 확인 ⭐ **최우선**
**목표**: AI 파이프라인이 실제로 작동하는지 확인

**작업 내용**:
- [ ] Supabase Edge Functions에 `GOOGLE_GEMINI_API_KEY` 설정 확인
- [ ] Supabase Dashboard → Edge Functions → Settings → Secrets 확인
- [ ] 또는 `supabase secrets list` 명령어로 확인
- [ ] 테스트 호출로 API 키 유효성 확인

**예상 시간**: 30분

---

#### 2. 프론트엔드 연동 테스트
**목표**: 실제 분석 플로우가 정상 작동하는지 확인

**작업 내용**:
- [ ] 실제 이미지 업로드 → 분석 플로우 테스트
- [ ] Edge Function 호출 확인
- [ ] 3단계 파이프라인 실행 확인
- [ ] 결과 DB 저장 확인
- [ ] 프론트엔드 결과 표시 확인
- [ ] 에러 발생 시 에러 메시지 확인

**예상 시간**: 1-2시간

---

#### 3. 에러 처리 개선
**목표**: 사용자 친화적 에러 메시지 및 재시도 로직

**작업 내용**:
- [ ] API 키 누락 시 친화적 에러 메시지
- [ ] 네트워크 에러 재시도 로직 (exponential backoff)
- [ ] 타임아웃 처리
- [ ] 이미지 크기 초과 시 명확한 안내
- [ ] Gemini API 에러 분류 및 처리

**예상 시간**: 2-3시간

---

### 🟡 **P1: 사용자 경험 개선 (1주)**

#### 4. 이미지 업로드 플로우 개선
**목표**: 안정적이고 사용자 친화적인 업로드 경험

**작업 내용**:
- [ ] 업로드 진행도 표시 (진행률 바)
- [ ] 이미지 품질 검증 피드백 (조명, 초점)
- [ ] 다중 각도 촬영 가이드 UI 개선
- [ ] 이미지 크기 초과 시 클라이언트 리사이즈 자동 실행
- [ ] 에러 처리 및 재시도 로직 강화

**예상 시간**: 2-3일

---

#### 5. 분석 결과 화면 개선
**목표**: 분석 결과를 명확하고 신뢰성 있게 표시

**작업 내용**:
- [ ] 히트맵 오버레이 표시/숨김 토글
- [ ] 피부 상태 점수 시각화 (막대 그래프, 레이더 차트)
- [ ] 추천 시술 카드 UI 개선
- [ ] 신뢰도 및 불확실성 표시
- [ ] 결과 저장 및 히스토리 연동 확인

**예상 시간**: 2일

---

#### 6. 히스토리 화면 기능 강화
**목표**: 사용자가 피부 개선 추이를 시각적으로 확인

**작업 내용**:
- [ ] Before/After 비교 기능
- [ ] 시간별 추이 그래프 (주간/월간)
- [ ] 개선 지표 요약 (AI 생성)
- [ ] 분석 기록 필터링 및 정렬
- [ ] 분석 기록 삭제 기능

**예상 시간**: 3-4일

---

#### 7. 시술 상세 화면 개선
**목표**: 추천 시술에 대한 상세 정보 제공

**작업 내용**:
- [ ] 시술 효과, 비용, 회복 기간 표시
- [ ] AI 생성 설명 문구 표시
- [ ] 관련 후기 요약 (향후 확장)
- [ ] "관심 등록" 기능 (MVP 제외 가능)

**예상 시간**: 2일

---

#### 8. 디자인 시스템 정리
**목표**: 일관된 UI/UX 및 빠른 개발

**작업 내용**:
- [ ] Design Tokens 정리 (색상, 폰트, 간격)
- [ ] 공통 컴포넌트 라이브러리 확장
  - Button, Input, Card, Modal, Toast 등
- [ ] 다크모드 지원 (선택사항)
- [ ] 반응형 디자인 개선

**예상 시간**: 3-4일

---

### 🟢 **P2: 품질 및 안정성 (2주)**

#### 9. 테스트 커버리지 확대
**목표**: 안정적인 배포 및 유지보수

**작업 내용**:
- [ ] Unit 테스트 (핵심 로직)
- [ ] Integration 테스트 (API 연동)
- [ ] E2E 테스트 (Playwright)
  - 회원가입 → 분석 → 결과 확인 플로우
- [ ] CI/CD 파이프라인 구축

**예상 시간**: 4-5일

---

#### 10. 모니터링 및 로깅
**목표**: 프로덕션 레벨 모니터링

**작업 내용**:
- [ ] Sentry 연동 (에러 추적)
- [ ] 사용자 친화적 에러 메시지
- [ ] 로깅 및 분석 이벤트 추가
- [ ] 성능 메트릭 수집

**예상 시간**: 2-3일

---

#### 11. 성능 최적화
**목표**: 빠른 로딩 및 부드러운 UX

**작업 내용**:
- [ ] 이미지 최적화 (lazy loading, WebP)
- [ ] 코드 스플리팅
- [ ] API 응답 캐싱 (React Query)
- [ ] 번들 크기 최적화

**예상 시간**: 2-3일

---

### 🔵 **P3: 확장 기능 (3주+)**

#### 12. 온보딩 개선
**목표**: 첫 사용자 경험 향상

**작업 내용**:
- [ ] 촬영 가이드 이미지 추가
- [ ] 품질 체크 가이드
- [ ] 튜토리얼 오버레이

**예상 시간**: 2일

---

#### 13. 알림 시스템
**목표**: 사용자 재방문 유도

**작업 내용**:
- [ ] 이메일 알림 (분석 완료, 추천 시술)
- [ ] 브라우저 푸시 알림 (선택사항)
- [ ] 알림 설정 페이지

**예상 시간**: 3-4일

---

#### 14. 다국어 지원 (i18n)
**목표**: 글로벌 확장 준비

**작업 내용**:
- [ ] i18n 라이브러리 도입
- [ ] 한국어/영어 번역
- [ ] 언어 선택 기능

**예상 시간**: 3-4일

---

## 📅 권장 개발 일정

### Week 1: P0 완성 (즉시 확인)
- 환경 변수 설정 확인
- 프론트엔드 연동 테스트
- 에러 처리 개선

### Week 2-3: P1 완성 (사용자 경험)
- 이미지 업로드 플로우 개선
- 분석 결과 화면 개선
- 히스토리 화면 강화
- 시술 상세 화면 개선
- 디자인 시스템 정리

### Week 4-5: P2 완성 (품질)
- 테스트 커버리지 확대
- 모니터링 및 로깅
- 성능 최적화

### Week 6+: P3 확장
- 온보딩 개선
- 알림 시스템
- 다국어 지원

---

## 🎯 MVP 출시 기준

다음 항목이 완료되면 MVP 출시 가능:

1. ✅ 회원가입/로그인
2. ✅ 이미지 업로드 및 분석
3. ✅ AI 분석 결과 표시 (3단계 파이프라인)
4. ✅ 추천 시술 표시
5. ✅ 기본 히스토리 조회
6. ⚠️ 에러 처리 기본 구현
7. ⚠️ 법적 면책 문구 표시

**현재 진행률**: 약 75% 완료

**남은 작업**: P0 항목 (환경 변수 확인, 테스트, 에러 처리)

---

## 💡 즉시 시작 가능한 작업

### 오늘 바로 시작할 수 있는 것:
1. **환경 변수 설정 확인** (30분)
   - Supabase Dashboard에서 `GOOGLE_GEMINI_API_KEY` 확인
   - 테스트 호출

2. **프론트엔드 연동 테스트** (1-2시간)
   - 실제 이미지 업로드 → 분석 플로우 테스트
   - 에러 확인 및 수정

3. **에러 처리 개선** (2-3시간)
   - API 키 누락 시 친화적 메시지
   - 네트워크 에러 재시도 로직

---

## 📝 참고사항

### 기술적 제약사항
- **Gemini API**: 외부 URL 직접 지원 안 함 → Base64 인코딩 필수
- **Supabase Storage**: Google Cloud Storage가 아니므로 `fileData` 사용 불가
- **이미지 리사이즈**: 클라이언트에서 처리 (Edge Function 리사이즈는 복잡)

### 비용 고려
- **AI API 호출 비용**: Gemini API 사용량 모니터링 필요
- **이미지 저장 비용**: Supabase Storage 사용량 모니터링
- **Edge Function 실행 시간**: 최적화로 비용 절감

### 법적 고려
- **의료 진단 금지**: 모든 결과에 면책 문구 필수
- **개인정보 보호**: 이미지 암호화 저장
- **데이터 보관**: 사용자 삭제 요청 시 즉시 삭제

### 보안
- **API 키 보호**: Edge Functions Secrets에만 저장
- **이미지 접근 제어**: Signed URL 사용 (TTL 제한)
- **인증**: 모든 API 호출에 토큰 검증

---

## 🚀 다음 단계

**즉시 시작**: P0 항목부터 진행
1. 환경 변수 설정 확인
2. 프론트엔드 연동 테스트
3. 에러 처리 개선

이 3가지만 완료하면 MVP 출시 가능!

